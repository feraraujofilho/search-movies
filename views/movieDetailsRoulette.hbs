{{#each movie}}
<div class="movie-details">
  <h1>{{this.title}}</h1>
  <p>Synopsis: {{this.synopsis}}</p>
  <img src={{this.image}} alt={{this.title}}>
  <p>Rating: {{this.rating}}</p>
  <p>Released Year: {{this.released}}</p>
  <p>Duration: {{this.runtime}}</p>
  <a href="https://www.netflix.com/title/{{this.netflixid}}">Watch now</a>
  <button onclick="addToSeen({{this.netflixid}},'{{this.title}}')">I have already seen this</button>
  <button onclick="addToWatchList({{this.netflixid}}, '{{this.title}}')">Add to Watch List</button>
</div>
{{/each}}

<button onclick="next()">Get New Suggestion</button>

<script>

  let showIndex = 0;

  const listOfMovies = document.querySelectorAll('.movie-details')
  console.log(listOfMovies)

  const show = () => {
    listOfMovies.forEach((x, i) => {
      if (i === showIndex) x.style.display = 'block'
      if (i !== showIndex) x.style.display = 'none'
    })
  }

  const next = () => {
    showIndex += 1
    console.log(showIndex)
    show()

  }
  show();

  const addToSeen = (netflixId, title) => {
    console.log('sent to BE - netflixId ', netflixId);
    console.log('sent to BE - title ', title);
    axios({
      method: 'post',
      url: '/movies/seen/',
      data: {
        netflixId,
        title
      }
    })
      .then(response => {
        console.log(response);
        next();
      })
      .then(err => {
        console.log(err)
      })
  };

  const addToWatchList = (netflixId, title) => {
    console.log('sent to BE - netflixId ', netflixId);
    console.log('sent to BE - title ', title);
    axios({
      method: 'post',
      url: '/movies/watchlist/',
      data: {
        netflixId,
        title
      }
    })
  };

</script>